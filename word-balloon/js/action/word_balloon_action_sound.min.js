document.addEventListener("DOMContentLoaded",function(){if(!document.getElementById("w_b_sound_icon_wrap")){return;}var b={flag:{},currentPlayID:null};document.getElementById("w_b_sound_icon_wrap").onclick=function(){var g=document.getElementById("w_b_sound_icon_wrap");if(g.getAttribute("data-current")==="play"){c();word_balloon_change_status_sound_icon_reset();word_balloon_change_status_box();return false;}var h=document.getElementById("w_b_sound_icon");var j=g.getAttribute("data-play");var f=g.getAttribute("data-stop");var d=g.getAttribute("data-speaker");var e=g.getAttribute("data-audio_url");var k=g.getAttribute("data-audio_id");if(typeof(b.flag[k])==="undefined"||b.flag[k]!==1){var i=document.createElement("audio");i.id=k;i.src=e;document.body.appendChild(i);}c();document.getElementById(k).play();h.src=f;g.setAttribute("data-current","play");b.currentPlayID=k;b.flag[k]=1;a(k);return false;};document.getElementById("w_b_status_sound_clear").onclick=function(){c();word_balloon_change_status_sound_icon_reset();document.getElementById("w_b_status_sound_filename").value="";document.getElementById("w_b_status_sound_id").value="";document.getElementById("w_b_status_sound_url").value="";word_balloon_change_status_box();return false;};function a(e){var d=document.getElementById(e);d.addEventListener("ended",function(f){word_balloon_change_status_sound_icon_reset();c();});}function c(){var d=document.getElementById(b.currentPlayID);if(d!=null){d.pause();d.currentTime=0;}b.currentPlayID=null;}});function word_balloon_change_status_sound_icon_reset(){var b=document.getElementById("w_b_sound_icon_wrap");var c=document.getElementById("w_b_sound_icon");var a=word_balloon_get_avatar_position();c.src=b.getAttribute("data-speaker");b.setAttribute("data-current","stop");if(a==="R"){c.classList.add("w_b_flip_h");}else{c.classList.remove("w_b_flip_h");}}function word_balloon_hover_status_sound_icon(d){var b=document.getElementById("w_b_sound_icon_wrap");var c=document.getElementById("w_b_sound_icon");var a=word_balloon_get_avatar_position();if(d==="enter"){if(b.getAttribute("data-current")==="play"){c.src=b.getAttribute("data-stop");}else{if(a==="R"){c.classList.remove("w_b_flip_h");}c.src=b.getAttribute("data-play");}}else{if(b.getAttribute("data-current")==="play"){c.src=b.getAttribute("data-stop");}else{if(a==="R"){c.classList.add("w_b_flip_h");}c.src=b.getAttribute("data-speaker");}}}function word_balloon_set_status_sound(b){var a;b.preventDefault();if(a){a.open();return;}a=wp.media({title:translations_word_balloon.select_a_sound,library:{type:"audio"},button:{text:translations_word_balloon.select},multiple:false});a.on("select",function(){var c=a.state().get("selection");c.each(function(d){document.getElementById("w_b_status_sound_filename").value=d.attributes.filename;document.getElementById("w_b_status_sound_id").value=d.attributes.id;document.getElementById("w_b_status_sound_url").value=d.attributes.url;word_balloon_change_status_box();});});a.open();}