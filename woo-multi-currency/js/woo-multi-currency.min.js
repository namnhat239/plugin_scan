jQuery(document).ready(function(a){"use strict";a(document.body).on("updated_checkout",function(c,b){b.hasOwnProperty("wmc_update_checkout")&&b.wmc_update_checkout&&a(document.body).trigger("update_checkout")}),a(document.body).on("payment_method_selected",function(b,c){"ppcp-gateway"===a('.woocommerce-checkout input[name="payment_method"]:checked').val()&&a(document.body).trigger("update_checkout")}),window.woo_multi_currency={init:function(){this.design(),this.checkPosition(),this.cacheCompatible(),this.ajaxComplete()},design:function(){768>=jQuery(window).width()?jQuery(".woo-multi-currency.wmc-sidebar").on("click",function(){jQuery(this).toggleClass("wmc-hover"),jQuery(this).hasClass("wmc-hover")?jQuery("html").css({overflow:"hidden"}):jQuery("html").css({overflow:"visible"})}):(jQuery(".woo-multi-currency.wmc-sidebar").on("mouseenter",function(){jQuery(this).addClass("wmc-hover")}),jQuery(".woo-multi-currency.wmc-sidebar").on("mouseleave",function(){jQuery(this).removeClass("wmc-hover")}))},checkPosition:function(){jQuery(".woo-multi-currency .wmc-currency-wrapper").on("mouseenter",function(){this.getBoundingClientRect().top/a(window).height()>.5?a(".woo-multi-currency .wmc-sub-currency").addClass("wmc-show-up"):a(".woo-multi-currency .wmc-sub-currency").removeClass("wmc-show-up")})},cacheCompatible(){if("1"===wooMultiCurrencyParams.enableCacheCompatible){if("undefined"!=typeof wc_checkout_params&&1===parseInt(wc_checkout_params.is_checkout))return;let b=[],d=a(".wmc-cache-pid");d.length&&d.each(function(e,d){let c=a(d).data("wmc_product_id");c&&b.push(c)});let e=a(".variations_form");e.length&&e.each(function(e,d){let c=a(d).data("product_variations");c.length&&c.forEach(a=>{b.push(a.variation_id)})});let f=a(".woo-multi-currency.wmc-shortcode").not(".wmc-list-currency-rates"),g=[];f.map(function(){let b=a(this);g.push({layout:b.data("layout")?b.data("layout"):"default",flag_size:b.data("flag_size")})}),b.length&&(b=[...new Set(b)]);let c=[];a(".wmc-cache-value").each(function(d,b){c.push({price:a(b).data("price"),original_price:a(b).data("original_price"),currency:a(b).data("currency"),product_id:a(b).data("product_id"),keep_format:a(b).data("keep_format")})}),c=[...new Set(c.map(JSON.stringify))].map(JSON.parse),a.ajax({url:wooMultiCurrencyParams.ajaxUrl,type:"POST",data:{action:"wmc_get_products_price",pids:b,shortcodes:g,wmc_current_url:a(".wmc-current-url").val(),exchange:c},success(b){if(b.success){let i=b.data.prices||"",e=b.data.current_currency||"",c=b.data.exchange||"";if(g.length>0&&g.length===b.data.shortcodes.length)for(let h=0;h<g.length;h++)f.eq(h).replaceWith(b.data.shortcodes[h]);if("1"!==wooMultiCurrencyParams.switchByJS&&a(".wmc-currency a").unbind(),e&&(a(".wmc-sidebar .wmc-currency").removeClass("wmc-active"),a(`.wmc-sidebar .wmc-currency[data-currency=${e}]`).addClass("wmc-active"),a(".wmc-price-switcher .wmc-current-currency i").removeClass().addClass("vi-flag-64 flag-"+b.data.current_country),a(".wmc-price-switcher .wmc-sub-currency-current").removeClass("wmc-sub-currency-current"),a(`.wmc-price-switcher .wmc-currency[data-currency=${e}]`).addClass("wmc-sub-currency-current"),a(`select.wmc-nav option[data-currency=${e}]`).prop("selected",!0)),"undefined"!=typeof woo_multi_currency_switcher&&woo_multi_currency_switcher.init(),i){for(let j in i)a(`.wmc-cache-pid[data-wmc_product_id=${j}]`).replaceWith(i[j]);a(".variations_form").each((d,c)=>{let b=a(c).data("product_variations");b&&(b.map(a=>{let b=a.variation_id;return a.price_html=i[b],a}),a(c).data("product_variations",b))})}if(c)for(let d in c)a(`.wmc-cache-value[data-price="${c[d].price}"][data-product_id="${c[d].product_id}"][data-keep_format="${c[d].keep_format}"][data-original_price="${c[d].original_price}"][data-currency="${c[d].currency}"]`).replaceWith(c[d].shortcode);jQuery(document.body).trigger("wmc_cache_compatible_finish",[b.data])}}})}},ajaxComplete(){a(document).on("append.infiniteScroll",()=>{this.cacheCompatible()})}},woo_multi_currency.init()})